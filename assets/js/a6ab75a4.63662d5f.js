"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[572],{1165(e,n,i){i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"concepts/memory/configuration","title":"Configuration","description":"Environment Variables","source":"@site/../docs/02-concepts/memory/configuration.md","sourceDirName":"02-concepts/memory","slug":"/concepts/memory/configuration","permalink":"/suzent/docs/concepts/memory/configuration","draft":false,"unlisted":false,"editUrl":"https://github.com/cyzus/suzent/tree/main/website/../docs/02-concepts/memory/configuration.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Architecture","permalink":"/suzent/docs/concepts/memory/architecture"},"next":{"title":"Troubleshooting","permalink":"/suzent/docs/concepts/memory/troubleshooting"}}');var r=i(4848),t=i(8453);const o={},l="Configuration",d={},a=[{value:"Environment Variables",id:"environment-variables",level:2},{value:"Database",id:"database",level:3},{value:"Embedding",id:"embedding",level:3},{value:"Extraction (Optional)",id:"extraction-optional",level:3},{value:"API Keys",id:"api-keys",level:3},{value:"Manager Initialization",id:"manager-initialization",level:2},{value:"Connection Pool",id:"connection-pool",level:2},{value:"System Constants",id:"system-constants",level:2},{value:"Tuning",id:"tuning",level:2},{value:"More Aggressive Storage",id:"more-aggressive-storage",level:3},{value:"Cleaner Memory",id:"cleaner-memory",level:3},{value:"Hybrid Search Weights",id:"hybrid-search-weights",level:3},{value:"Embedding Models",id:"embedding-models",level:2},{value:"Changing Embedding Model",id:"changing-embedding-model",level:2},{value:"Docker Compose",id:"docker-compose",level:2},{value:"Debug Logging",id:"debug-logging",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"configuration",children:"Configuration"})}),"\n",(0,r.jsx)(n.h2,{id:"environment-variables",children:"Environment Variables"}),"\n",(0,r.jsx)(n.h3,{id:"database",children:"Database"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"POSTGRES_HOST=127.0.0.1\nPOSTGRES_PORT=5430\nPOSTGRES_DB=suzent\nPOSTGRES_USER=suzent\nPOSTGRES_PASSWORD=password\n"})}),"\n",(0,r.jsx)(n.h3,{id:"embedding",children:"Embedding"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"EMBEDDING_MODEL=text-embedding-3-large  # or text-embedding-3-small\nEMBEDDING_DIMENSION=3072                # Auto-detected if omitted\n"})}),"\n",(0,r.jsx)(n.h3,{id:"extraction-optional",children:"Extraction (Optional)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"MEMORY_EXTRACTION_MODEL=gpt-4o-mini    # Enables automatic extraction\n"})}),"\n",(0,r.jsx)(n.h3,{id:"api-keys",children:"API Keys"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"OPENAI_API_KEY=sk-xxx\n"})}),"\n",(0,r.jsx)(n.h2,{id:"manager-initialization",children:"Manager Initialization"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from suzent.memory import MemoryManager, PostgresMemoryStore\n\nconnection_string = f"postgresql://{user}:{password}@{host}:{port}/{db}"\n\nstore = PostgresMemoryStore(connection_string)\nawait store.connect()\n\nmanager = MemoryManager(\n    store=store,\n    embedding_model="text-embedding-3-large",\n    embedding_dimension=3072,  # Optional\n    llm_for_extraction="gpt-4o-mini"  # Optional\n)\n'})}),"\n",(0,r.jsx)(n.h2,{id:"connection-pool",children:"Connection Pool"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"store = PostgresMemoryStore(\n    connection_string,\n    min_size=2,\n    max_size=10,\n    command_timeout=60\n)\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Recommendations:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Dev: min=1, max=5"}),"\n",(0,r.jsx)(n.li,{children:"Prod: min=5, max=20"}),"\n",(0,r.jsx)(n.li,{children:"High traffic: min=10, max=50"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"system-constants",children:"System Constants"}),"\n",(0,r.jsxs)(n.p,{children:["Defined in ",(0,r.jsx)(n.code,{children:"manager.py"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"DEFAULT_MEMORY_RETRIEVAL_LIMIT = 5\nDEFAULT_MEMORY_SEARCH_LIMIT = 10\nIMPORTANT_MEMORY_THRESHOLD = 0.7\nDEDUPLICATION_SIMILARITY_THRESHOLD = 0.85\nDEFAULT_IMPORTANCE = 0.5\n"})}),"\n",(0,r.jsx)(n.h2,{id:"tuning",children:"Tuning"}),"\n",(0,r.jsx)(n.h3,{id:"more-aggressive-storage",children:"More Aggressive Storage"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"DEDUPLICATION_SIMILARITY_THRESHOLD = 0.75\nDEFAULT_IMPORTANCE = 0.6\n"})}),"\n",(0,r.jsx)(n.h3,{id:"cleaner-memory",children:"Cleaner Memory"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"DEDUPLICATION_SIMILARITY_THRESHOLD = 0.90\nDEFAULT_IMPORTANCE = 0.3\n"})}),"\n",(0,r.jsx)(n.h3,{id:"hybrid-search-weights",children:"Hybrid Search Weights"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"results = await store.hybrid_search(\n    ...,\n    semantic_weight=0.7,      # Vector similarity\n    fts_weight=0.3,           # Full-text\n    importance_boost=0.2,     # Importance\n    recency_boost=0.1         # Recency\n)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"embedding-models",children:"Embedding Models"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Model"}),(0,r.jsx)(n.th,{children:"Dimension"}),(0,r.jsx)(n.th,{children:"Cost/1M tokens"}),(0,r.jsx)(n.th,{children:"Use Case"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"text-embedding-3-large"}),(0,r.jsx)(n.td,{children:"3072"}),(0,r.jsx)(n.td,{children:"$0.13"}),(0,r.jsx)(n.td,{children:"Production"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"text-embedding-3-small"}),(0,r.jsx)(n.td,{children:"1536"}),(0,r.jsx)(n.td,{children:"$0.02"}),(0,r.jsx)(n.td,{children:"Development"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"text-embedding-ada-002"}),(0,r.jsx)(n.td,{children:"1536"}),(0,r.jsx)(n.td,{children:"$0.10"}),(0,r.jsx)(n.td,{children:"Legacy"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"changing-embedding-model",children:"Changing Embedding Model"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Update environment:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"EMBEDDING_MODEL=text-embedding-3-small\nEMBEDDING_DIMENSION=1536\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"Alter database:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"ALTER TABLE archival_memories ALTER COLUMN embedding TYPE vector(1536);\nDROP INDEX idx_archival_memories_embedding;\nCREATE INDEX idx_archival_memories_embedding ON archival_memories\nUSING ivfflat (embedding vector_cosine_ops) WITH (lists = 100);\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:"Optional: Clear old embeddings:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"TRUNCATE archival_memories;\n"})}),"\n",(0,r.jsx)(n.h2,{id:"docker-compose",children:"Docker Compose"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"version: '3.8'\nservices:\n  postgres:\n    image: pgvector/pgvector:pg18\n    environment:\n      POSTGRES_USER: suzent\n      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD}\n      POSTGRES_DB: suzent\n    ports:\n      - \"5430:5432\"\n    volumes:\n      - postgres_data:/var/lib/postgresql/data\n      - ./schema.sql:/docker-entrypoint-initdb.d/schema.sql\n\nvolumes:\n  postgres_data:\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Start: ",(0,r.jsx)(n.code,{children:"docker-compose up -d"})]}),"\n",(0,r.jsx)(n.h2,{id:"debug-logging",children:"Debug Logging"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import logging\nlogging.basicConfig(level=logging.DEBUG)\n"})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453(e,n,i){i.d(n,{R:()=>o,x:()=>l});var s=i(6540);const r={},t=s.createContext(r);function o(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);