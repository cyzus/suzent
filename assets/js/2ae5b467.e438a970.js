"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[817],{3319(e,s,n){n.r(s),n.d(s,{assets:()=>o,contentTitle:()=>r,default:()=>a,frontMatter:()=>t,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"concepts/filesystem","title":"Filesystem & Execution","description":"Suzent provides secure file access and code execution through two modes: Sandbox Mode (isolated MicroVM) and Host Mode (direct execution with restrictions).","source":"@site/../docs/02-concepts/filesystem.md","sourceDirName":"02-concepts","slug":"/concepts/filesystem","permalink":"/suzent/docs/concepts/filesystem","draft":false,"unlisted":false,"editUrl":"https://github.com/cyzus/suzent/tree/main/website/../docs/02-concepts/filesystem.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Suzent Quickstart Guide","permalink":"/suzent/docs/getting-started/quickstart"},"next":{"title":"Memory System","permalink":"/suzent/docs/concepts/memory/"}}');var l=n(4848),d=n(8453);const t={},r="Filesystem & Execution",o={},c=[{value:"Execution Modes",id:"execution-modes",level:2},{value:"Virtual Filesystem (Both Modes)",id:"virtual-filesystem-both-modes",level:2},{value:"Custom Volume Mounts",id:"custom-volume-mounts",level:3},{value:"Sandbox Mode",id:"sandbox-mode",level:2},{value:"Features",id:"features",level:3},{value:"Setup",id:"setup",level:3},{value:"Host Mode",id:"host-mode",level:2},{value:"Environment Variables",id:"environment-variables",level:3},{value:"Security",id:"security",level:3},{value:"File Tools",id:"file-tools",level:2},{value:"ReadFileTool",id:"readfiletool",level:3},{value:"WriteFileTool",id:"writefiletool",level:3},{value:"EditFileTool",id:"editfiletool",level:3},{value:"GlobTool",id:"globtool",level:3},{value:"GrepTool",id:"greptool",level:3},{value:"Security",id:"security-1",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2}];function h(e){const s={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.header,{children:(0,l.jsx)(s.h1,{id:"filesystem--execution",children:"Filesystem & Execution"})}),"\n",(0,l.jsxs)(s.p,{children:["Suzent provides secure file access and code execution through two modes: ",(0,l.jsx)(s.strong,{children:"Sandbox Mode"})," (isolated MicroVM) and ",(0,l.jsx)(s.strong,{children:"Host Mode"})," (direct execution with restrictions)."]}),"\n",(0,l.jsx)(s.h2,{id:"execution-modes",children:"Execution Modes"}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{children:"Mode"}),(0,l.jsx)(s.th,{children:"BashTool"}),(0,l.jsx)(s.th,{children:"File Tools"}),(0,l.jsx)(s.th,{children:"Path Style"})]})}),(0,l.jsxs)(s.tbody,{children:[(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.strong,{children:"Sandbox"})}),(0,l.jsx)(s.td,{children:"Runs in MicroVM"}),(0,l.jsx)(s.td,{children:"Virtual filesystem"}),(0,l.jsxs)(s.td,{children:[(0,l.jsx)(s.code,{children:"/persistence"}),", ",(0,l.jsx)(s.code,{children:"/shared"}),", ",(0,l.jsx)(s.code,{children:"/mnt/*"})]})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.strong,{children:"Host"})}),(0,l.jsx)(s.td,{children:"Runs on host"}),(0,l.jsx)(s.td,{children:"Host filesystem"}),(0,l.jsxs)(s.td,{children:[(0,l.jsx)(s.code,{children:"$PERSISTENCE_PATH"}),", ",(0,l.jsx)(s.code,{children:"$SHARED_PATH"}),", ",(0,l.jsx)(s.code,{children:"$MOUNT_*"})]})]})]})]}),"\n",(0,l.jsx)(s.p,{children:"Toggle sandbox in the chat settings when creating a conversation."}),"\n",(0,l.jsx)(s.hr,{}),"\n",(0,l.jsx)(s.h2,{id:"virtual-filesystem-both-modes",children:"Virtual Filesystem (Both Modes)"}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{children:"Virtual Path"}),(0,l.jsx)(s.th,{children:"Maps To"}),(0,l.jsx)(s.th,{children:"Purpose"})]})}),(0,l.jsxs)(s.tbody,{children:[(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"/persistence"})}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:".suzent/sandbox/sessions/{chat_id}/"})}),(0,l.jsx)(s.td,{children:"Per-chat storage"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"/shared"})}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:".suzent/sandbox/shared/"})}),(0,l.jsx)(s.td,{children:"Shared across all chats"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"/uploads"})}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:".suzent/sandbox/sessions/{chat_id}/uploads/"})}),(0,l.jsx)(s.td,{children:"Uploaded files"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"/mnt/*"})}),(0,l.jsx)(s.td,{children:"Custom volumes"}),(0,l.jsx)(s.td,{children:"Host directories"})]})]})]}),"\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.strong,{children:"Relative paths"})," default to ",(0,l.jsx)(s.code,{children:"/persistence"}),": ",(0,l.jsx)(s.code,{children:"data.csv"})," \u2192 ",(0,l.jsx)(s.code,{children:"/persistence/data.csv"})]}),"\n",(0,l.jsx)(s.h3,{id:"custom-volume-mounts",children:"Custom Volume Mounts"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-yaml",children:'# config/default.yaml\nsandbox_volumes:\n  - "D:/datasets:/data"\n  - "D:/skills:/mnt/skills"\n'})}),"\n",(0,l.jsxs)(s.p,{children:["Now ",(0,l.jsx)(s.code,{children:"/data/file.csv"})," maps to ",(0,l.jsx)(s.code,{children:"D:/datasets/file.csv"})," on your host."]}),"\n",(0,l.jsx)(s.hr,{}),"\n",(0,l.jsx)(s.h2,{id:"sandbox-mode",children:"Sandbox Mode"}),"\n",(0,l.jsxs)(s.p,{children:["Uses ",(0,l.jsx)(s.strong,{children:"Microsandbox"})," (Firecracker MicroVMs) for isolated execution."]}),"\n",(0,l.jsx)(s.h3,{id:"features",children:"Features"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Isolation"}),": Each session runs in its own MicroVM"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Auto-Healing"}),": Automatically restarts crashed sessions"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Multi-language"}),": Python, Node.js, shell commands"]}),"\n"]}),"\n",(0,l.jsx)(s.h3,{id:"setup",children:"Setup"}),"\n",(0,l.jsxs)(s.ol,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Docker"}),": Required to run ",(0,l.jsx)(s.code,{children:"microsandbox"})," service"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Configure"})," ",(0,l.jsx)(s.code,{children:"docker/sandbox-compose.yml"}),":"]}),"\n"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-yaml",children:"services:\n  microsandbox:\n    image: microsandbox/microsandbox:latest\n    privileged: true\n    volumes:\n      - microsandbox-data:/root/.local/share/microsandbox\n      - ..:/workspace\n      # Windows: Map for custom volumes\n      - C:/Users:/mnt/c/Users\n"})}),"\n",(0,l.jsxs)(s.ol,{start:"3",children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Configure"})," ",(0,l.jsx)(s.code,{children:"config/default.yaml"}),":"]}),"\n"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-yaml",children:'sandbox_enabled: true\nsandbox_server_url: "http://localhost:7263"\n'})}),"\n",(0,l.jsx)(s.hr,{}),"\n",(0,l.jsx)(s.h2,{id:"host-mode",children:"Host Mode"}),"\n",(0,l.jsx)(s.p,{children:"Executes directly on the host machine with path restrictions."}),"\n",(0,l.jsx)(s.h3,{id:"environment-variables",children:"Environment Variables"}),"\n",(0,l.jsx)(s.p,{children:"In host mode, use these environment variables in bash commands:"}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{children:"Variable"}),(0,l.jsx)(s.th,{children:"Points To"})]})}),(0,l.jsxs)(s.tbody,{children:[(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"$PERSISTENCE_PATH"})}),(0,l.jsxs)(s.td,{children:["Session directory (same as ",(0,l.jsx)(s.code,{children:"pwd"}),")"]})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"$SHARED_PATH"})}),(0,l.jsx)(s.td,{children:"Shared directory"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"$MOUNT_SKILLS"})}),(0,l.jsx)(s.td,{children:"Skills directory"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"$MOUNT_*"})}),(0,l.jsx)(s.td,{children:"Other mounted volumes"})]})]})]}),"\n",(0,l.jsx)(s.h3,{id:"security",children:"Security"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:["Working directory (",(0,l.jsx)(s.code,{children:"pwd"}),") is the session's persistence folder"]}),"\n",(0,l.jsxs)(s.li,{children:["Only paths within ",(0,l.jsx)(s.code,{children:".suzent/"}),", ",(0,l.jsx)(s.code,{children:"/persistence"}),", ",(0,l.jsx)(s.code,{children:"/shared"}),", and custom mounts are allowed"]}),"\n",(0,l.jsxs)(s.li,{children:["Source code directories are ",(0,l.jsx)(s.strong,{children:"blocked"})," by default"]}),"\n"]}),"\n",(0,l.jsx)(s.hr,{}),"\n",(0,l.jsx)(s.h2,{id:"file-tools",children:"File Tools"}),"\n",(0,l.jsx)(s.h3,{id:"readfiletool",children:"ReadFileTool"}),"\n",(0,l.jsx)(s.p,{children:"Read files with automatic format conversion (text, PDF, DOCX, XLSX, images with OCR)."}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-python",children:'ReadFileTool(file_path="/persistence/data.csv")\nReadFileTool(file_path="report.pdf", offset=10, limit=50)\n'})}),"\n",(0,l.jsx)(s.h3,{id:"writefiletool",children:"WriteFileTool"}),"\n",(0,l.jsx)(s.p,{children:"Create or overwrite files."}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-python",children:'WriteFileTool(file_path="/persistence/output.txt", content="Hello")\n'})}),"\n",(0,l.jsxs)(s.blockquote,{children:["\n",(0,l.jsxs)(s.p,{children:["[!WARNING]\nOverwrites entire file. Use ",(0,l.jsx)(s.code,{children:"EditFileTool"})," for small changes."]}),"\n"]}),"\n",(0,l.jsx)(s.h3,{id:"editfiletool",children:"EditFileTool"}),"\n",(0,l.jsx)(s.p,{children:"Make precise text replacements."}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-python",children:'EditFileTool(\n    file_path="config.json",\n    old_string=\'"debug": false\',\n    new_string=\'"debug": true\'\n)\n'})}),"\n",(0,l.jsx)(s.h3,{id:"globtool",children:"GlobTool"}),"\n",(0,l.jsx)(s.p,{children:"Find files by pattern."}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-python",children:'GlobTool(pattern="**/*.py")  # All Python files\nGlobTool(pattern="*.csv", path="/data")  # CSVs in /data\n'})}),"\n",(0,l.jsx)(s.h3,{id:"greptool",children:"GrepTool"}),"\n",(0,l.jsx)(s.p,{children:"Search file contents."}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-python",children:'GrepTool(pattern="def.*:", path="/persistence")  # Find functions\nGrepTool(pattern="TODO", include="*.py")  # TODOs in Python files\n'})}),"\n",(0,l.jsx)(s.hr,{}),"\n",(0,l.jsx)(s.h2,{id:"security-1",children:"Security"}),"\n",(0,l.jsx)(s.p,{children:"All paths are validated to prevent directory traversal:"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:["\u2705 ",(0,l.jsx)(s.code,{children:"/persistence/data.csv"})]}),"\n",(0,l.jsxs)(s.li,{children:["\u2705 ",(0,l.jsx)(s.code,{children:"/shared/model.pt"})]}),"\n",(0,l.jsxs)(s.li,{children:["\u2705 ",(0,l.jsx)(s.code,{children:"/data/file.txt"})," (if mounted)"]}),"\n",(0,l.jsxs)(s.li,{children:["\u274c ",(0,l.jsx)(s.code,{children:"/etc/passwd"})]}),"\n",(0,l.jsxs)(s.li,{children:["\u274c ",(0,l.jsx)(s.code,{children:"../../../secret"})]}),"\n",(0,l.jsx)(s.li,{children:"\u274c Project source code (in host mode)"}),"\n"]}),"\n",(0,l.jsx)(s.hr,{}),"\n",(0,l.jsx)(s.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{children:"Issue"}),(0,l.jsx)(s.th,{children:"Solution"})]})}),(0,l.jsxs)(s.tbody,{children:[(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.strong,{children:"File not found"})}),(0,l.jsxs)(s.td,{children:["Check ",(0,l.jsx)(s.code,{children:".suzent/sandbox/sessions/{chat_id}/"})]})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.strong,{children:"Path traversal error"})}),(0,l.jsx)(s.td,{children:"Ensure path is within allowed directories"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.strong,{children:"Volume not accessible"})}),(0,l.jsxs)(s.td,{children:["Verify ",(0,l.jsx)(s.code,{children:"sandbox_volumes"})," in config"]})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.strong,{children:"Timeout/ConnectionRefused"})}),(0,l.jsxs)(s.td,{children:["Check ",(0,l.jsx)(s.code,{children:"sandbox_server_url"})," and Docker status"]})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.strong,{children:"WSL issues"})}),(0,l.jsxs)(s.td,{children:["Use WSL IP instead of ",(0,l.jsx)(s.code,{children:"localhost"})]})]})]})]})]})}function a(e={}){const{wrapper:s}={...(0,d.R)(),...e.components};return s?(0,l.jsx)(s,{...e,children:(0,l.jsx)(h,{...e})}):h(e)}},8453(e,s,n){n.d(s,{R:()=>t,x:()=>r});var i=n(6540);const l={},d=i.createContext(l);function t(e){const s=i.useContext(d);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function r(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),i.createElement(d.Provider,{value:s},e.children)}}}]);